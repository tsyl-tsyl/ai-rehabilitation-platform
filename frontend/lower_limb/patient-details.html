<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>患者详情 - 康复训练管理系统</title>
  <!-- 引入Tailwind CSS -->
    <script src="../libs/tailwindcss/tailwindcss.js"></script>
    <!-- 本地Font Awesome -->
    <link href="../libs/font-awesome/font-awesome.min.css" rel="stylesheet">
  <!-- 引入Chart.js -->
    <script src="../libs/chart/chart.js"></script>
  
  <!-- 配置Tailwind -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#0066CC',
            secondary: '#1E88E5',
            accent: '#64B5F6',
            dark: '#0D47A1',
            light: '#E3F2FD',
            deep: '#0A3A7A',
            med: '#1565C0',
            success: '#10B981',
            warning: '#F59E0B',
            danger: '#EF4444'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .card-gradient {
        background: linear-gradient(135deg, #1E88E5 0%, #0D47A1 100%);
      }
      .bg-grid {
        background-image: 
          radial-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 1px),
          linear-gradient(to bottom, rgba(10, 58, 122, 0.9), rgba(21, 101, 192, 0.7));
        background-size: 20px 20px, 100% 100%;
      }
      .border-glow {
        box-shadow: 0 0 15px rgba(100, 181, 246, 0.5);
      }
      .pulse-glow {
        animation: pulse-glow 2s infinite;
      }
      @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 15px rgba(100, 181, 246, 0.5); }
        50% { box-shadow: 0 0 25px rgba(100, 181, 246, 0.8); }
      }
      .fade-in {
        animation: fadeIn 1s ease-in-out;
      }
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      .modal-enter {
        animation: modalEnter 0.3s ease-out;
      }
      @keyframes modalEnter {
        from {
          opacity: 0;
          transform: scale(0.9) translateY(-20px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }
    }
    
    .text-gray-500 {
      color: rgba(156, 163, 175, 0.8) !important;
    }
    
    .empty-state {
      color: rgba(156, 163, 175, 0.7) !important;
    }
    
    .empty-state i {
      opacity: 0.5;
    }
    
    .hover-card {
      transition: all 0.3s ease;
    }
    
    .hover-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .form-input:focus {
      box-shadow: 0 0 0 3px rgba(100, 181, 246, 0.1);
    }
    
    .status-tag {
        padding-left: 0.75rem;
        padding-right: 0.75rem;
        padding-top: 0.25rem;
        padding-bottom: 0.25rem;
        font-size: 0.875rem;
        line-height: 1.25rem;
        border-radius: 9999px;
        border: 1px solid;
    }
    
    .status-acute {
        background-color: rgba(239, 68, 68, 0.2);
        color: rgb(252, 165, 165);
        border-color: rgba(248, 113, 113, 0.3);
    }
    
    .status-recovery {
        background-color: rgba(59, 130, 246, 0.2);
        color: rgb(147, 197, 253);
        border-color: rgba(96, 165, 250, 0.3);
    }
    
    .status-maintenance {
        background-color: rgba(16, 185, 129, 0.2);
        color: rgb(110, 231, 183);
        border-color: rgba(52, 211, 153, 0.3);
    }
    /* 自定义下拉菜单样式 */
            select {
                background-color: rgba(255, 255, 255, 0.1) !important;
                color: white !important;
            }
            
            select option {
                background-color: #0A3A7A !important;
                color: white !important;
            }
            
            select:focus {
                background-color: rgba(255, 255, 255, 0.15) !important;
            }
  </style>
</head>

<body class="bg-gradient-to-br from-deep to-med min-h-screen text-white overflow-x-hidden bg-grid">
  <!-- 顶部装饰线条 -->
  <div class="absolute top-0 left-0 right-0 h-1 bg-accent"></div>
  
  <!-- 页面容器 -->
  <div class="container mx-auto px-4 py-8 relative z-10">
    <!-- 顶部导航 -->
    <header class="flex justify-between items-center mb-8 fade-in">
      <div class="flex items-center">
        <div class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center mr-3">
          <i class="fa fa-heartbeat text-xl text-light"></i>
        </div>
        <div class="text-xl font-semibold" data-i18n="system_name">康复训练管理系统</div>
      </div>
      <div class="flex items-center space-x-4">
        <div class="text-right">
          <div class="text-sm opacity-80" id="currentDateTime">加载中...</div>
          <div class="text-sm opacity-80" data-i18n="patient_detail_management">患者详情管理</div>
        </div>
        <!-- 语言切换按钮 -->
        <button id="languageSwitch" class="px-3 py-1 bg-accent hover:bg-accent/80 rounded text-sm transition-all duration-300">
          <span data-i18n="switchToEnglish">English</span>
        </button>
      </div>
    </header>
    
    <!-- 返回按钮和患者信息 -->
    <div class="flex justify-between items-center mb-6">
      <button onclick="window.location.href='doctor.html'" class="px-4 py-2 bg-accent hover:bg-accent/80 rounded-lg transition-all duration-300 font-medium flex items-center">
        <i class="fa fa-arrow-left mr-2"></i> <span data-i18n="back_to_dashboard">返回医生工作台</span>
      </button>
      
      <div class="text-right">
        <h1 class="text-3xl font-bold" id="patientName">加载中...</h1>
        <div class="text-sm opacity-80" id="patientInfo">患者ID: 加载中...</div>
      </div>
    </div>
    
    <!-- 标签页导航 -->
    <div class="bg-white/5 rounded-xl p-1 mb-8 fade-in">
      <div class="flex space-x-1">
        <button id="tab-stages" class="tab-btn flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 bg-accent text-white" onclick="switchTab('stages')">
          <i class="fa fa-calendar mr-2"></i><span data-i18n="rehab_stages">康复阶段</span>
        </button>
        <button id="tab-rom" class="tab-btn flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 bg-transparent hover:bg-white/5" onclick="switchTab('rom')">
          <i class="fa fa-chart-line mr-2"></i><span data-i18n="joint_mobility">关节活动度</span>
        </button>
        <button id="tab-progress" class="tab-btn flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 bg-transparent hover:bg-white/5" onclick="switchTab('progress')">
          <i class="fa fa-tasks mr-2"></i><span data-i18n="rehab_progress">康复进度</span>
        </button>
        <button id="tab-training" class="tab-btn flex-1 py-3 px-4 rounded-lg font-medium transition-all duration-300 bg-transparent hover:bg-white/5" onclick="switchTab('training')">
          <i class="fa fa-dumbbell mr-2"></i><span data-i18n="training_plans">训练计划</span>
        </button>
      </div>
    </div>
    
    <!-- 康复阶段管理 -->
    <div id="content-stages" class="tab-content fade-in">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold" data-i18n="rehab_stage_management">康复阶段管理</h2>
        <button onclick="showAddStageModal()" class="px-4 py-2 bg-accent hover:bg-accent/80 rounded-lg transition-all duration-300 font-medium flex items-center">
          <i class="fa fa-plus mr-2"></i> <span data-i18n="add_rehab_stage">添加康复阶段</span>
        </button>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
        <!-- 当前阶段概览 -->
        <div class="card-gradient rounded-2xl p-6 shadow-lg border border-accent/30 border-glow">
          <h3 class="text-xl font-bold mb-4" data-i18n="current_rehab_stage">当前康复阶段</h3>
          <div id="currentStageInfo" class="text-center py-8">
            <div class="text-lg">加载中...</div>
          </div>
        </div>
        
        <!-- 阶段统计 -->
        <div class="bg-white/5 rounded-2xl p-6 border border-white/10">
          <h3 class="text-xl font-bold mb-4" data-i18n="stage_statistics">阶段统计</h3>
          <div class="grid grid-cols-2 gap-4">
            <div class="text-center p-4 bg-white/5 rounded-lg">
              <div class="text-2xl font-bold text-accent" id="totalStages">0</div>
              <div class="text-sm opacity-80" data-i18n="total_stages">总阶段数</div>
            </div>
            <div class="text-center p-4 bg-white/5 rounded-lg">
              <div class="text-2xl font-bold text-success" id="activeStages">0</div>
              <div class="text-sm opacity-80" data-i18n="in_progress">进行中</div>
            </div>
            <div class="text-center p-4 bg-white/5 rounded-lg">
              <div class="text-2xl font-bold text-warning" id="completedStages">0</div>
              <div class="text-sm opacity-80" data-i18n="completed">已完成</div>
            </div>
            <div class="text-center p-4 bg-white/5 rounded-lg">
              <div class="text-2xl font-bold text-blue-400" id="plannedStages">0</div>
              <div class="text-sm opacity-80" data-i18n="planned">待开始</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 阶段列表 -->
      <div class="bg-white/5 rounded-xl p-6">
        <h3 class="text-xl font-bold mb-4" data-i18n="all_rehab_stages">所有康复阶段</h3>
        <div id="rehabilitationStagesList">
          <div class="text-center py-12 empty-state">
            <i class="fa fa-calendar-plus text-5xl mb-4"></i>
            <div class="text-xl mb-2" data-i18n="no_rehab_stages">暂无康复阶段记录</div>
            <div class="text-sm opacity-70" data-i18n="no_rehab_stages_desc">请添加康复阶段信息来开始管理患者的康复过程</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 关节活动度管理 -->
    <div id="content-rom" class="tab-content hidden fade-in">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold" data-i18n="joint_mobility_records">关节活动度记录</h2>
        <div class="flex space-x-3">
          <button onclick="exportROMData()" class="px-4 py-2 bg-green-500 hover:bg-green-600 rounded-lg transition-all duration-300 font-medium flex items-center">
            <i class="fa fa-download mr-2"></i> <span data-i18n="export_data">导出数据</span>
          </button>
          <button onclick="showAddROMModal()" class="px-4 py-2 bg-accent hover:bg-accent/80 rounded-lg transition-all duration-300 font-medium flex items-center">
            <i class="fa fa-plus mr-2"></i> <span data-i18n="add_record">添加记录</span>
          </button>
        </div>
      </div>
      
      <!-- 活动度趋势图表 -->
      <div class="bg-white/5 rounded-xl p-6 mb-6">
        <h3 class="text-xl font-bold mb-4" data-i18n="joint_mobility_trend">关节活动度趋势</h3>
        <div class="h-80">
          <canvas id="romTrendChart"></canvas>
        </div>
      </div>
      
      <!-- 记录列表 -->
      <div class="bg-white/5 rounded-xl p-6">
        <h3 class="text-xl font-bold mb-4" data-i18n="mobility_records_list">活动度记录列表</h3>
        <div id="jointROMList">
          <div class="text-center py-12 empty-state">
            <i class="fa fa-chart-line text-5xl mb-4"></i>
            <div class="text-xl mb-2" data-i18n="no_joint_mobility_records">暂无关节活动度记录</div>
            <div class="text-sm opacity-70" data-i18n="no_joint_mobility_records_desc">请添加关节活动度测量数据来跟踪患者的康复进展</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 康复进度跟踪 -->
    <div id="content-progress" class="tab-content hidden fade-in">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold" data-i18n="rehab_progress_tracking">康复进度跟踪</h2>
        <div class="flex space-x-3">
          <button onclick="generateProgressReport()" class="px-4 py-2 bg-green-500 hover:bg-green-600 rounded-lg transition-all duration-300 font-medium flex items-center">
            <i class="fa fa-file-pdf-o mr-2"></i> <span data-i18n="generate_report">生成报告</span>
          </button>
          <button onclick="showAddProgressModal()" class="px-4 py-2 bg-accent hover:bg-accent/80 rounded-lg transition-all duration-300 font-medium flex items-center">
            <i class="fa fa-plus mr-2"></i> <span data-i18n="add_record">添加记录</span>
          </button>
        </div>
      </div>
      
      <!-- 进度概览 -->
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
        <div class="card-gradient rounded-2xl p-6 shadow-lg border border-accent/30 border-glow">
          <div class="text-center">
            <div class="text-4xl font-bold mb-2" id="overallProgress">0%</div>
            <div class="text-lg" data-i18n="overall_rehab_progress">整体康复进度</div>
            <div class="w-full bg-white/20 rounded-full h-3 mt-4">
              <div class="bg-accent h-3 rounded-full" id="overallProgressBar" style="width: 0%"></div>
            </div>
          </div>
        </div>
        
        <div class="bg-white/5 rounded-2xl p-6 border border-white/10">
          <div class="text-center">
            <div class="text-3xl font-bold text-success mb-2" id="avgJointMobility">0%</div>
            <div class="text-lg" data-i18n="joint_mobility">关节活动度</div>
            <div class="text-sm opacity-80 mt-2" data-i18n="average_progress">平均进度</div>
          </div>
        </div>
        
        <div class="bg-white/5 rounded-2xl p-6 border border-white/10">
          <div class="text-center">
            <div class="text-3xl font-bold text-warning mb-2" id="avgMuscleStrength">0%</div>
            <div class="text-lg" data-i18n="muscle_strength_recovery">肌力恢复</div>
            <div class="text-sm opacity-80 mt-2" data-i18n="average_progress">平均进度</div>
          </div>
        </div>
      </div>
      
      <!-- 进度趋势图表 -->
      <div class="bg-white/5 rounded-xl p-6 mb-6">
        <h3 class="text-xl font-bold mb-4" data-i18n="rehab_progress_trend">康复进度趋势</h3>
        <div class="h-80">
          <canvas id="progressTrendChart"></canvas>
        </div>
      </div>
      
      <!-- 进度记录列表 -->
      <div class="bg-white/5 rounded-xl p-6">
        <h3 class="text-xl font-bold mb-4" data-i18n="progress_records_list">进度记录列表</h3>
        <div id="progressTrackingList">
          <div class="text-center py-12 empty-state">
            <i class="fa fa-tasks text-5xl mb-4"></i>
            <div class="text-xl mb-2" data-i18n="no_progress_records">暂无康复进度记录</div>
            <div class="text-sm opacity-70" data-i18n="no_progress_records_desc">请添加康复进度跟踪信息来监控患者的恢复情况</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- 训练计划管理 -->
    <div id="content-training" class="tab-content hidden fade-in">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold" data-i18n="training_plan_management">训练计划管理</h2>
        <button onclick="showAddTrainingPlanModal()" class="px-4 py-2 bg-accent hover:bg-accent/80 rounded-lg transition-all duration-300 font-medium flex items-center">
          <i class="fa fa-plus mr-2"></i> <span data-i18n="add_training_plan">添加训练计划</span>
        </button>
      </div>
      
      <!-- 训练统计 -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-xl p-4 border border-blue-400/30">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-white" id="totalPlans">0</div>
              <div class="text-sm opacity-80" data-i18n="total_plans">总计划数</div>
            </div>
            <div class="w-10 h-10 bg-blue-500/30 rounded-full flex items-center justify-center">
              <i class="fa fa-list-alt text-blue-300"></i>
            </div>
          </div>
        </div>
        
        <div class="bg-gradient-to-br from-green-500/20 to-green-600/20 rounded-xl p-4 border border-green-400/30">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-white" id="activePlans">0</div>
              <div class="text-sm opacity-80" data-i18n="in_progress">进行中</div>
            </div>
            <div class="w-10 h-10 bg-green-500/30 rounded-full flex items-center justify-center">
              <i class="fa fa-play-circle text-green-300"></i>
            </div>
          </div>
        </div>
        
        <div class="bg-gradient-to-br from-purple-500/20 to-purple-600/20 rounded-xl p-4 border border-purple-400/30">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-white" id="completedPlans">0</div>
              <div class="text-sm opacity-80" data-i18n="completed">已完成</div>
            </div>
            <div class="w-10 h-10 bg-purple-500/30 rounded-full flex items-center justify-center">
              <i class="fa fa-check-circle text-purple-300"></i>
            </div>
          </div>
        </div>
        
        <div class="bg-gradient-to-br from-orange-500/20 to-orange-600/20 rounded-xl p-4 border border-orange-400/30">
          <div class="flex items-center justify-between">
            <div>
              <div class="text-2xl font-bold text-white" id="complianceRate">0%</div>
              <div class="text-sm opacity-80" data-i18n="compliance_rate">依从率</div>
            </div>
            <div class="w-10 h-10 bg-orange-500/30 rounded-full flex items-center justify-center">
              <i class="fa fa-chart-line text-orange-300"></i>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 训练计划列表 -->
      <div class="bg-white/5 rounded-xl p-6">
        <h3 class="text-xl font-bold mb-4" data-i18n="training_plans_list">训练计划列表</h3>
        <div id="trainingPlansList">
          <div class="text-center py-12 empty-state">
            <i class="fa fa-dumbbell text-5xl mb-4"></i>
            <div class="text-xl mb-2" data-i18n="no_training_plans">暂无训练计划</div>
            <div class="text-sm opacity-70" data-i18n="no_training_plans_desc">请为患者制定个性化的训练计划</div>
          </div>
        </div>
      </div>
    </div>


      <!-- 底部信息 -->
  <footer class="text-center pt-8 border-t border-white/10 fade-in mt-12">
    <div class="flex flex-col md:flex-row justify-between items-center">
      <div class="mb-4 md:mb-0">
        <div class="flex items-center justify-center md:justify-start">
          <div class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center mr-2">
            <i class="fa fa-heartbeat text-sm text-light"></i>
          </div>
          <span class="font-semibold" data-i18n="system_name">康复训练管理系统</span>
        </div>
        <div class="text-sm opacity-70 mt-1" data-i18n="system_slogan">科技赋能康复，智能改善生活</div>
      </div>
      
      <div class="text-sm opacity-70">
        © 2025 <span data-i18n="system_name">康复训练管理系统</span> - <span data-i18n="system_description">基于AI的精准康复解决方案</span>
      </div>
    </div>
  </footer>
  </div>
  

  
  <!-- 背景装饰元素 -->
  <div class="absolute top-0 left-0 w-full h-full pointer-events-none">
    <div class="absolute top-10 left-10 w-40 h-40 rounded-full bg-accent/10 blur-3xl"></div>
    <div class="absolute bottom-10 right-10 w-60 h-60 rounded-full bg-primary/20 blur-3xl"></div>
    <div class="absolute top-1/2 left-1/4 w-32 h-32 rounded-full bg-accent/5 blur-3xl"></div>
  </div>
</body>
<script src="../static/js/common.js"></script>
 <script src="../static/js/i18nManage.js"></script>
<!-- 引入所有模态框 -->
<script src="../static/js/modals.js?2"></script>

<!-- 主JavaScript代码 -->
<script>


// 页面加载完成后执行
document.addEventListener('DOMContentLoaded',async function() {
 
    // 初始化国际化
  await i18n.init();
    
    // 添加语言切换事件
    document.getElementById('languageSwitch').addEventListener('click', switchLanguage);

     creatModal();
    
    initializePage();
    // 更新日期时间显示
    updateDateTime();
    setInterval(updateDateTime, 1000);
  
});

 

// 更新日期时间显示
function updateDateTime() {
    const now = new Date();
    const options = { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        weekday: 'long'
    };
    
    if (i18n.currentLanguage === 'zh-CN') {
        document.getElementById('currentDateTime').textContent = now.toLocaleString('zh-CN', options);
    } else {
        document.getElementById('currentDateTime').textContent = now.toLocaleString('en-US', options);
    }
}

// 标签页切换功能
function switchTab(tabName) {
    // 隐藏所有内容区域
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
    });
    
    // 移除所有标签页的活动状态
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('bg-accent', 'text-white');
        btn.classList.add('bg-transparent', 'hover:bg-white/5');
    });
    
    // 显示选中的内容区域
    document.getElementById('content-' + tabName).classList.remove('hidden');
    
    // 设置选中的标签页为活动状态
    document.getElementById('tab-' + tabName).classList.add('bg-accent', 'text-white');
    document.getElementById('tab-' + tabName).classList.remove('bg-transparent', 'hover:bg-white/5');
}
</script>

<script src="../static/js/patient-details.js?2"></script>
</html>